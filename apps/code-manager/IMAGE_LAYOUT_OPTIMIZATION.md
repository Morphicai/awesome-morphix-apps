# 优惠券图片布局优化

## 🎨 优化内容

### 问题
之前的垂直堆叠布局导致内容超出画布高度，底部被截断。

### 解决方案
采用**左右分栏布局**，充分利用横向空间。

## 📐 新布局设计

```
┌─────────────────────────────────────────────────┐
│                                                 │
│              【主内容居中】                     │
│                                                 │
│              公司名称                           │
│              优惠券                             │
│              ¥100                               │
│                                                 │
│              仅限一次                           │
│                                                 │
│              ABC123                             │
│              有效期至：2025-12-31               │
│                                                 │
│                                    ┌──────┐    │
│                                    │ QR码 │    │
│                                    └──────┘    │
└─────────────────────────────────────────────────┘
```

## ✨ 布局特点

### 主内容区域（居中显示）
- ✅ 公司名称（如果有）
- ✅ "优惠券"标题
- ✅ 金额/折扣（大字显示）
- ✅ 备注信息（自动换行）
- ✅ 优惠券编码
- ✅ 有效期信息
- ✅ 所有内容水平居中

### 二维码区域（右下角）
- ✅ 尺寸缩小50%（80x80）
- ✅ 固定在右下角
- ✅ 不遮挡主要内容
- ✅ 移除"扫码领取"文字

## 🎯 优化效果

### 空间利用
- ✅ 充分利用横向空间
- ✅ 避免内容被截断
- ✅ 所有信息完整显示

### 视觉效果
- ✅ 左右分区清晰
- ✅ 信息层次分明
- ✅ 二维码突出显示
- ✅ 整体更加美观

### 响应式设计
- ✅ 二维码尺寸自适应
- ✅ 文本自动换行
- ✅ 适配不同画布尺寸

## 📊 布局参数

```javascript
{
  centerX: config.width / 2,        // 水平居中
  padding: 40,                       // 边距
  originalQrSize: 160,               // 原始二维码尺寸
  qrSize: 160 * 0.5,                // 缩小50% = 80
  qrPadding: 20,                     // 二维码边距
  qrX: config.width - 80 - 20,      // 右下角X坐标
  qrY: config.height - 80 - 20      // 右下角Y坐标
}
```

## 🔧 技术细节

### 文本对齐
- 左侧：左对齐（`textAlign: 'left'`）
- 右侧：居中对齐（二维码和提示文字）

### 垂直定位
- 左侧：从上到下流式布局
- 右侧：二维码垂直居中

### 自动换行
```javascript
// 备注文本自动换行
const maxWidth = leftWidth - padding * 2;
const lines = this._wrapText(ctx, coupon.note, maxWidth);
```

## 📱 显示效果

### 金额券示例
```
┌─────────────────────────────────────┐
│ 测试公司                            │
│ 优惠券              ┌─────────┐    │
│ ¥100                │         │    │
│                     │  [QR]   │    │
│ 满200减100          │         │    │
│                     └─────────┘    │
│ ABC123               扫码领取      │
│ 有效期至：2025-12-31               │
└─────────────────────────────────────┘
```

### 折扣券示例
```
┌─────────────────────────────────────┐
│ 读书的蘑菇 ACT矩阵                  │
│ 优惠券              ┌─────────┐    │
│ 8折                 │         │    │
│                     │  [QR]   │    │
│ 仅限一次            │         │    │
│                     └─────────┘    │
│ DEF456               扫码领取      │
│ 有效期至：2025-12-31               │
└─────────────────────────────────────┘
```

## 🎉 优化成果

- ✅ 内容不再被截断
- ✅ 布局更加合理
- ✅ 视觉效果更好
- ✅ 信息展示完整
- ✅ 二维码更加突出

所有内容都能完整显示在画布内！
